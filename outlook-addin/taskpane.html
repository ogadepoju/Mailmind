<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MailMind</title>
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;600&family=Syne:wght@700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0a0f;
    --surface: #12121a;
    --border: #1e1e2e;
    --accent: #00e5ff;
    --accent2: #7c3aed;
    --green: #10b981;
    --amber: #f59e0b;
    --red: #ef4444;
    --text: #e2e8f0;
    --muted: #64748b;
    --subtle: #334155;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    font-size: 12px;
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  /* ─── HEADER ─── */
  .header {
    padding: 14px 16px;
    border-bottom: 1px solid var(--border);
    background: #070710;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-shrink: 0;
  }

  .header-left { display: flex; align-items: center; gap: 10px; }

  .logo {
    width: 32px; height: 32px;
    background: linear-gradient(135deg, #0a0a0f, #1a1a2e);
    border: 1px solid var(--accent);
    border-radius: 8px;
    display: flex; align-items: center; justify-content: center;
    font-size: 16px; color: var(--accent);
    box-shadow: 0 0 12px rgba(0,229,255,0.2);
  }

  .brand-name {
    font-family: 'Syne', sans-serif;
    font-size: 15px; font-weight: 800;
    background: linear-gradient(135deg, #fff 0%, var(--accent) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .brand-sub { font-size: 9px; color: var(--muted); margin-top: 1px; letter-spacing: 0.1em; }

  .engine-badge {
    font-size: 9px;
    padding: 3px 8px;
    background: rgba(124,58,237,0.15);
    border: 1px solid rgba(124,58,237,0.3);
    border-radius: 10px;
    color: #a78bfa;
    letter-spacing: 0.05em;
  }

  /* ─── EMAIL CARD ─── */
  .email-card {
    margin: 12px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px 12px;
    flex-shrink: 0;
  }

  .email-row {
    display: flex;
    gap: 8px;
    align-items: baseline;
    margin-bottom: 3px;
  }
  .email-row:last-child { margin-bottom: 0; }

  .email-key {
    font-size: 9px;
    text-transform: uppercase;
    letter-spacing: 0.15em;
    color: var(--muted);
    min-width: 40px;
    flex-shrink: 0;
  }

  .email-val {
    font-size: 11px;
    color: var(--text);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    flex: 1;
  }

  .email-val.accent { color: var(--accent); }

  /* ─── STATUS BAR ─── */
  .status-bar {
    margin: 0 12px 12px;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 11px;
    display: flex;
    align-items: center;
    gap: 10px;
    flex-shrink: 0;
    transition: all 0.3s;
  }

  .status-bar.drafting {
    background: rgba(245,158,11,0.08);
    border: 1px solid rgba(245,158,11,0.25);
    color: var(--amber);
  }

  .status-bar.ready {
    background: rgba(0,229,255,0.06);
    border: 1px solid rgba(0,229,255,0.2);
    color: var(--accent);
  }

  .status-bar.error {
    background: rgba(239,68,68,0.08);
    border: 1px solid rgba(239,68,68,0.25);
    color: var(--red);
  }

  .status-bar.idle {
    background: rgba(100,116,139,0.08);
    border: 1px solid rgba(100,116,139,0.15);
    color: var(--muted);
  }

  .status-spinner {
    width: 14px; height: 14px;
    border: 2px solid rgba(245,158,11,0.2);
    border-top-color: var(--amber);
    border-radius: 50%;
    animation: spin 0.7s linear infinite;
    flex-shrink: 0;
  }

  @keyframes spin { to { transform: rotate(360deg); } }

  /* ─── DRAFT AREA ─── */
  .draft-section {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    margin: 0 12px;
  }

  .draft-label {
    font-size: 9px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 6px;
    flex-shrink: 0;
  }

  .draft-textarea {
    flex: 1;
    width: 100%;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 8px;
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    font-size: 12px;
    line-height: 1.75;
    padding: 12px;
    resize: none;
    outline: none;
    transition: border-color 0.15s;
    min-height: 120px;
  }

  .draft-textarea:focus { border-color: rgba(0,229,255,0.35); }
  .draft-textarea::placeholder { color: var(--subtle); }
  .draft-textarea:disabled { opacity: 0.4; cursor: not-allowed; }

  /* ─── ACTIONS ─── */
  .actions {
    padding: 12px 12px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    flex-shrink: 0;
    border-top: 1px solid var(--border);
    margin-top: 12px;
  }

  .actions-row { display: flex; gap: 8px; }

  .btn {
    flex: 1;
    padding: 10px 14px;
    border-radius: 7px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    font-weight: 600;
    cursor: pointer;
    border: 1px solid;
    transition: all 0.15s;
    text-align: center;
    letter-spacing: 0.03em;
  }

  .btn:disabled { opacity: 0.45; cursor: not-allowed; }

  .btn-send {
    background: var(--green);
    color: #0a0a0f;
    border-color: var(--green);
  }
  .btn-send:hover:not(:disabled) { background: #34d399; box-shadow: 0 0 16px rgba(16,185,129,0.3); }

  .btn-regen {
    background: transparent;
    color: var(--muted);
    border-color: var(--border);
  }
  .btn-regen:hover:not(:disabled) { color: var(--text); border-color: var(--muted); }

  .btn-draft {
    background: var(--accent);
    color: #0a0a0f;
    border-color: var(--accent);
  }
  .btn-draft:hover:not(:disabled) { background: #33eaff; box-shadow: 0 0 16px rgba(0,229,255,0.3); }

  /* ─── PRIVACY NOTE ─── */
  .privacy-note {
    text-align: center;
    font-size: 10px;
    color: var(--subtle);
    padding-bottom: 4px;
  }

  /* ─── SENT STATE ─── */
  .sent-view {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 24px;
    text-align: center;
  }

  .sent-icon { font-size: 36px; color: var(--green); }
  .sent-title { font-family: 'Syne', sans-serif; font-size: 16px; font-weight: 800; color: var(--text); }
  .sent-sub { font-size: 11px; color: var(--muted); line-height: 1.6; }

  /* ─── ERROR DETAIL ─── */
  .error-detail {
    font-size: 10px;
    color: var(--muted);
    line-height: 1.6;
    margin-top: 4px;
  }

  .error-detail code {
    display: block;
    margin-top: 8px;
    background: var(--surface);
    padding: 8px 10px;
    border-radius: 4px;
    color: var(--accent);
    font-size: 10px;
  }

  /* ─── HIDDEN/SHOWN HELPERS ─── */
  .hidden { display: none !important; }
</style>
</head>
<body>

<!-- Header -->
<div class="header">
  <div class="header-left">
    <div class="logo">✦</div>
    <div>
      <div class="brand-name">MailMind</div>
      <div class="brand-sub">AI Reply Assistant</div>
    </div>
  </div>
  <div class="engine-badge">Claude AI</div>
</div>

<!-- Email metadata -->
<div class="email-card">
  <div class="email-row">
    <span class="email-key">From</span>
    <span class="email-val accent" id="meta-from">Loading…</span>
  </div>
  <div class="email-row">
    <span class="email-key">Subject</span>
    <span class="email-val" id="meta-subject">—</span>
  </div>
</div>

<!-- Status bar -->
<div class="status-bar idle hidden" id="status-bar">
  <span id="status-icon"></span>
  <span id="status-text"></span>
</div>

<!-- Main content area — switches between states -->

<!-- Draft view -->
<div id="view-draft" class="hidden" style="flex:1;display:flex;flex-direction:column;overflow:hidden;">
  <div class="draft-section">
    <div class="draft-label">AI Draft — review before sending</div>
    <textarea class="draft-textarea" id="draft-textarea" placeholder="Draft will appear here…"></textarea>
  </div>
  <div class="actions">
    <div class="actions-row">
      <button class="btn btn-regen" id="btn-regen">↺ Regenerate</button>
      <button class="btn btn-send" id="btn-send">✓ Send Reply</button>
    </div>
    <div class="privacy-note">✦ Drafted with Claude AI · MailMind</div>
  </div>
</div>

<!-- Idle view (no email open / initial) -->
<div id="view-idle" style="flex:1;display:flex;flex-direction:column;padding:12px;gap:10px;">
  <div style="color:var(--muted);font-size:11px;line-height:1.7;padding:8px 0;">
    Open an email to automatically generate a draft reply, or click below to draft manually.
  </div>
  <button class="btn btn-draft" id="btn-manual-draft" style="flex:0">✦ Draft Reply Now</button>
  <div id="error-box" class="hidden" style="margin-top:8px;">
    <div style="color:var(--red);font-size:11px;font-weight:600;" id="error-title">Error</div>
    <div class="error-detail" id="error-detail"></div>
    <button class="btn btn-regen" id="btn-retry" style="margin-top:10px;flex:0;width:100%">↺ Retry</button>
  </div>
</div>

<!-- Sent view -->
<div id="view-sent" class="hidden" style="flex:1;">
  <div class="sent-view">
    <div class="sent-icon">✓</div>
    <div class="sent-title">Reply Sent</div>
    <div class="sent-sub">Your reply was sent successfully.<br>MailMind is ready for the next email.</div>
    <button class="btn btn-regen" id="btn-after-sent" style="margin-top:8px;width:100%">← Back</button>
  </div>
</div>

<script src="taskpane.js"></script>
</body>
</html>
